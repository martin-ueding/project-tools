#!/bin/bash
# Copyright Â© 2012-2013 Martin Ueding <dev@martin-ueding.de>

# Creates a new repository on github, adds the remote and pushes.

set -e
set -u

server_alias=github

repo="$1"

. ~/.config/project-tools/git-init-github.sh

curl -u "$user:$password" https://api.github.com/user/repos -d "{\"name\":\"${repo}\"}"

if git remote | grep "$server_alias"
then
	echo "Notice: $repo already had remote $server_alias."
	git remote rm "$server_alias"
fi

git remote add "$server_alias" "git@github.com:$(git config github.user)/$repo.git" --mirror=push

git push "$server_alias" --mirror
